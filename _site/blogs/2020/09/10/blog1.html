<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c">
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Executable and Linkable Format - Sections and Segments | TourPran Blogs</title>
<meta name="generator" content="Jekyll v4.2.0">
<meta property="og:title" content="Executable and Linkable Format - Sections and Segments">
<meta name="author" content="tourpran">
<meta property="og:locale" content="en_US">
<meta name="description" content="Start:">
<meta property="og:description" content="Start:">
<link rel="canonical" href="http://tourpran.me/blogs/2020/09/10/blog1.html">
<meta property="og:url" content="http://tourpran.me/blogs/2020/09/10/blog1.html">
<meta property="og:site_name" content="TourPran Blogs">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2020-09-10T00:00:00+05:30">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Executable and Linkable Format - Sections and Segments">
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Executable and Linkable Format - Sections and Segments","dateModified":"2020-09-10T00:00:00+05:30","datePublished":"2020-09-10T00:00:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"http://tourpran.me/blogs/2020/09/10/blog1.html"},"author":{"@type":"Person","name":"tourpran"},"url":"http://tourpran.me/blogs/2020/09/10/blog1.html","description":"Start:","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="shortcut icon" href="">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
  <!-- and it's easy to individually load additional languages -->
  <script charset="UTF-8" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/go.min.js"></script>
  <link rel="stylesheet" href="/assets/css/main.css">
  <script src="/assets/js/main.js"></script><link type="application/atom+xml" rel="alternate" href="http://tourpran.me/feed.xml" title="TourPran Blogs">
</head>
<body>



















<header class="site-header " role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
<span class="site-brand"><a class="site-brand-inner" rel="author" href="/">
  <img class="site-favicon" title="TourPran Blogs" src="" onerror="this.style.display='none'">
  TourPran Blogs
</a>
</span><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger">
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
<a class="page-link" href="/">HOME</a><a class="page-link" href="/archives.html">ARCHIVES</a><a class="page-link" href="/categories.html">CATEGORIES</a><a class="page-link" href="/portfolio.html">PORTFOLIO</a>




<span class="page-link">

<div id="google_translate_element" style="display: none;">
</div>

<span class="ct-language">
  <ul class="list-unstyled ct-language-dropdown">
    
      <li>
        <a href="#" class="lang-select" data-lang="en">
          
          <img src="https://www.countryflags.io/us/flat/64.png" title="English">
          
        </a>
      </li>
    
  </ul>
</span>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: '',
    autoDisplay: false,
    layout: google.translate.TranslateElement.InlineLayout.VERTICAL
  }, 'google_translate_element');

  function restoreLang() {
    var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
    if (!iframe) return;

    var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
    var restore_el = innerDoc.getElementsByTagName("button");

    for (var i = 0; i < restore_el.length; i++) {
      if (restore_el[i].id.indexOf("restore") >= 0) {
        restore_el[i].click();
        var close_el = innerDoc.getElementsByClassName("goog-close-link");
        close_el[0].click();
        return;
      }
    }
  }

  function triggerHtmlEvent(element, eventName) {
    var event;
    if (document.createEvent) {
      event = document.createEvent('HTMLEvents');
      event.initEvent(eventName, true, true);
      element.dispatchEvent(event);
    } else {
      event = document.createEventObject();
      event.eventType = eventName;
      element.fireEvent('on' + event.eventType, event);
    }
  }

  var googleCombo = document.querySelector("select.goog-te-combo");
  var langSelect = document.querySelector('.ct-language');
  langSelect.addEventListener('click', function(event) {
    if (!event.target) {
      return;
    }

    var selected = document.querySelector('.ct-language .ct-language-selected');
    if (selected) {
      selected.classList.remove('ct-language-selected');
    }

    var target = event.target;
    while (target && target !== langSelect ) {
      if (target.matches('.lang-select')) {
        break;
      }
      target = target.parentElement;
    }

    if (target && target.matches('.lang-select')) {
      var lang = target.getAttribute('data-lang');
      if (googleCombo.value == lang) {
        restoreLang();
      } else {
        target.parentElement.classList.add('ct-language-selected');
        googleCombo.value = lang;
        triggerHtmlEvent(googleCombo, 'change');
      }
    }

    event.preventDefault();
  });
}
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</span>
</div>
        </nav>
</div>
  </div>
</header>

<script>
  (function() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  })();
</script>










































<script>
  function hashLocate(hashValue) {
    hashValue = hashValue.replace(/^.*#h-/, '');
    var element = document.getElementById(hashValue);

    if (!element) {
      return;
    }

    var header = document.querySelector('header.site-header');
    var headerRect = header.getBoundingClientRect();
    var headerTop = Math.floor(headerRect.top);
    var headerHeight = Math.floor(headerRect.height);
    var scrollPos = getScrollPos();
    var offsetY = element.offsetTop - (headerTop + headerHeight + 20);

    if (offsetY == scrollPos.y) {
      return;
    }

    if (headerTop == 0  && offsetY > scrollPos.y) {
      offsetY += headerHeight + 2;
    } else if (headerTop < 0  && offsetY < scrollPos.y) {
      offsetY -= headerHeight - 2;
    }

    smoothScrollTo(offsetY);
  }

  // The first event occurred
  window.addEventListener('load', function(event) {
    if (window.location.hash) {
      hashLocate(window.location.hash);
    }
  });

  // The first event occurred
  window.addEventListener('click', function(event) {
    if (event.target.matches('a')) {
      hashLocate(event.target.getAttribute('href'));
    }
  });
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="framework">
  <section class="main">

     <div class="post">
  <section>









<header class="post-header">
  <h1 class="post-title p-name" itemprop="name headline">Executable and Linkable Format - Sections and Segments</h1>
  <h3 class="post-subtitle"></h3>

  <p class="post-meta">
    <time class="dt-published" datetime="2020-09-10T00:00:00+05:30" itemprop="datePublished"><i class="fa fa-calendar"></i> 10 Sep 2020
    </time>

    





















    <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 4 mins</span>
  </p>
<div class="post-tags">
<a class="post-tag" href="/tags.html#ELF%20segment">#ELF segment</a><a class="post-tag" href="/tags.html#ELF%20section">#ELF section</a>
</div></header>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="post-content e-content" itemprop="articleBody">

      <h2 id="start">Start:</h2>

<p>So the ELF or Excecutable and Linkable format are programs or binaries that are used in linux systems. ELFs contain 3 components namely:</p>
<ul>
  <li>ELF Headers</li>
  <li>ELF Segments</li>
  <li>ELF Sections</li>
</ul>

<h3 id="need">Need:</h3>

<p>A good reason to learn ELF format is it helps you to understand things easily when you do binary analysis or when you are curious to know how the Operating System works. There are several reasons why you need to know them â€¦</p>

<h2 id="elf-headers">ELF Headers</h2>

<p>Firstly we will be looking at ELF which are 64 bits, dynamically linked, not stripped.
<img src="/assets/images/2.png" alt=""></p>

<p>Lets look at the ELF header with readelf.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>readelf -h binary
</code></pre></div></div>
<p><img src="/assets/images/1.png" alt=""></p>

<h3 id="magic">magic</h3>
<p>We can see from the image that our header / binary starts with the magic bytes Magic: 45 4c 46 which corresponds to ELF in ascii. This magic bytes tell the file command that this is an Excecutable and Linkable Format.</p>

<h3 id="class">Class</h3>
<p>This binary has a class of 64 bits because when I compiled, it was in a 64 bit machine so by default it will be 64 bits. Inorder to compile a 32 bit binary we need to give the -m32 flag to gcc.</p>

<h3 id="data">Data</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Little Endian</th>
      <th style="text-align: center">Big Endian</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">The bytes of a word are arranged from right to left</td>
      <td style="text-align: center">The bytes of a word are arranged from left to right</td>
    </tr>
    <tr>
      <td style="text-align: center">The address of the word (assume 4 bytes) will point to 4 th bytes</td>
      <td style="text-align: center">The address of that word (assume 4 bytes) will point to the 1st bytes</td>
    </tr>
  </tbody>
</table>

<p>So in our case its little endian and most 64 bit amd processors compile it in little Endian.</p>

<h3 id="osabi">OS/ABI</h3>

<p>Nothing to tell about OS (Operating System). I compiled this is my laptop which is Linux hence Unix.</p>

<h3 id="machine">Machine</h3>

<p>Tells us we have x86 architecture with 64 bits.</p>

<h3 id="type">type</h3>

<p>Not sure why its DYN(Shared Object). It should have been EXEC (Executable file).[will update soon].</p>

<h3 id="rest">Rest</h3>

<p>Rest of the information is regarding addresses and Size of sections and headers.</p>

<h2 id="segments-aka-program-headers">Segments (aka Program Headers)</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>readelf -h ``binary``
</code></pre></div></div>
<p><img src="/assets/images/3.png" alt=""></p>

<p>This is a array of structures. Each describes the segments. The segments are used to tell, how to create a memory image when the binary is excecuted. When the Kernel sees these segments it will map them into the Virtual Memory with the help of mmap system call.</p>

<h3 id="phdr">PHDR</h3>

<p>Tells the location of the Program header itself if its present.</p>

<h3 id="interp">interp</h3>

<p>specifies the location and size of a null-terminated path name to invoke as an interpreter</p>

<ul>
  <li>
    <p>interpreter</p>
  </li>
  <li>
    <ul>
      <li>It is a program that excecutes certain specified instructions [not to worry now].</li>
    </ul>
  </li>
</ul>

<h3 id="dynamic">dynamic</h3>

<p>This segment specifies the information needed for the dynamic linking process.</p>

<h3 id="gnu_eh_frame">GNU_EH_FRAME</h3>

<p>This stores exceptional handlers. When things go wrong this area can deal with it.</p>

<h3 id="gnu_stack">GNU_STACK</h3>

<ul>
  <li>stack</li>
  <li>
    <ul>
      <li>This is just a place where things can be stored during runtime.</li>
    </ul>
  </li>
</ul>

<p>This GNU_STACK is responsible for the stack being excecutable. If this is not there then by default stack will be excecutable. If stack is enabled then user input can also be excecuted and can lead to a great havoc.</p>

<h2 id="elf-sections">ELF Sections</h2>

<p>This is also commonly called as section headers. This has the information needed for linking a target object file (dependencies) to the binary. This is needed on linktime but not on runtime.</p>

<h3 id="common-sections">Common Sections</h3>
<ul>
  <li>.text: This section contains the code for the binary.</li>
  <li>.data: Holds all the initialised data.</li>
  <li>.rodata: Holds the initialised read-only data.</li>
  <li>.bss: Contain all the uninitialized data.</li>
  <li>.plt: PLT (Procedure Linkage Table) is useful when it comes to getting address of functions in dynamically linked libraries.</li>
  <li>.got: Contains all the resolved address of the functions from the dependecies.</li>
  <li>.dynamic: Holds all needed information for dynamic linking.</li>
  <li>.dynsym: table dedicated to dynamically linked symbols.</li>
  <li>.strtab: string table of .symtab section.</li>
  <li>.dynstr: string table of .dynsym section.</li>
  <li>.interp: RTLD embedded string.</li>
</ul>

<h2 id="end">END</h2>
<p>Hope you understood some basic concepts related to the ELF file format.</p>

<h2 id="sources">sources:</h2>
<p><a href="https://www.intezer.com/blog/research/executable-linkable-format-101-part1-sections-segments/">intezer</a>
<a href="https://linux-audit.com/elf-binaries-on-linux-understanding-and-analysis/#program-headers">linux-audit</a></p>


    </div>

</article>
<div class="post-nav">
<a class="previous" href="/youtube/2020/08/30/video4.html" title="Bruteforcing the Canary - 03">Bruteforcing the Canary - 03</a><a class="next" href="/blogs/2020/09/11/blog2.html" title="Dynamic and Static Linking">Dynamic and Static Linking</a>
</div>
<div class="post-related">
      <div>Related Articles</div>
      <ul>
        <li><a class="post-link" href="/writeup/2020/04/30/pwnabletw2.html" title="Dynamic and Static Linking">ORW - pwnable.tw</a></li>
<li><a class="post-link" href="/youtube/2020/07/28/introduction.html" title="Dynamic and Static Linking">Introduction to Assembly Programming - 00</a></li>
<li><a class="post-link" href="/blogs/2020/09/10/blog1.html" title="Dynamic and Static Linking">Executable and Linkable Format - Sections and Segments</a></li>
<li><a class="post-link" href="/youtube/2020/08/01/video2.html" title="Dynamic and Static Linking">Reverse engineering Binaries - 01</a></li>
</ul>
    </div>
<div class="post-comments">  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://tourpran.me/blogs/2020/09/10/blog1.html';
      this.page.identifier = 'http://tourpran.me/blogs/2020/09/10/blog1.html';
    };

    (function() {
      var d = document, s = d.createElement('script');

      // s.src = 'https://tourpran.disqus.com/embed.js';
      // s.src = 'https://jeffreytse.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
</div></section>
</div>


  </section>
  <section class="sidebar" style="margin-left: 15px;">
    <!-- Get sidebar items --><style type="text/css" media="screen">
.post-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
</style>

<div class="post-menu">
  <div class="post-menu-title">TOC</div>
  <div class="post-menu-content"></div>
</div>

<script>
  function generateContent() {
    var menu = document.querySelector(".post-menu");
    var menuContent =  menu.querySelector(".post-menu-content");
    var headings = document.querySelector(".post-content").querySelectorAll("h2, h3, h4, h5, h6");

    // Hide menu when no headings
    if (headings.length === 0) {
      return menu.style.display = "none";
    }

    // Generate post menu
    var menuHTML = '';
    for (var i = 0; i < headings.length; i++) {
      var h = headings[i];
      menuHTML += (
        '<li class="h-' + h.tagName.toLowerCase() + '">'
        + '<a href="#h-' + h.getAttribute('id') + '">' + h.textContent + '</a></li>');
    }

    menuContent.innerHTML = '<ul>' + menuHTML + '</ul>';

    // The header element
    var header = document.querySelector('header.site-header');

    function doMenuCollapse(index, over_items=20) {
      var items = menuContent.firstChild.children;

      if (items.length < over_items) {
        return;
      }

      var activeItem = items[index];
      var beginItem = activeItem
      var endItem = activeItem
      var beginIndex = index;
      var endIndex = index + 1;
      while (beginIndex >= 0
        && !items[beginIndex].classList.contains('h-h2')) {
        beginIndex -= 1;
      }
      while (endIndex < items.length
        && !items[endIndex].classList.contains('h-h2')) {
        endIndex += 1;
      }
      for (var i = 0; i < beginIndex; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
      for (var i = beginIndex + 1; i < endIndex; i++) {
        item = items[i]
        // if (!item.classList.contains('h-h2')) {
          item.style.display = '';
        // }
      }
      for (var i = endIndex; i < items.length; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
    }

    // Init menu collapsed
    doMenuCollapse(-1);

    // Active the menu item
    window.addEventListener('scroll', function (event) {
      var lastActive = menuContent.querySelector('.active');
      var changed = true;
      var activeIndex = -1;
      for (var i = headings.length - 1; i >= 0; i--) {
        var h = headings[i];
        var headingRect = h.getBoundingClientRect();
        var headerRect = header.getBoundingClientRect();
        var headerTop = Math.floor(headerRect.top);
        var headerHeight = Math.floor(headerRect.height);
        var headerHeight = headerTop + headerHeight + 20;
        if (headingRect.top <= headerHeight) {
          var id = 'h-' + h.getAttribute('id');
          var a = menuContent.querySelector('a[href="#' + id  + '"]');
          var curActive = a.parentNode;
          if (curActive) {
            curActive.classList.add('active');
            activeIndex = i;
          }
          if (lastActive == curActive) {
            changed = false;
          }
          break;
        }
      }
      if (changed) {
        if (lastActive) {
          lastActive.classList.remove('active');
        }
        doMenuCollapse(activeIndex);
      }
      event.preventDefault();
    });
  }
  generateContent();
</script>
</section>
</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

</footer>
</body>
</html>
